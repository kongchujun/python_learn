import pandas as pd
from sqlalchemy import create_engine

# 创建一个DataFrame作为示例
data = {
    'name': ['Alice', 'Bob', 'Charlie'],
    'age': [25, 30, 35],
    'city': ['New York', 'Los Angeles', 'Chicago']
}
df = pd.DataFrame(data)

# 创建数据库连接
engine = create_engine('postgresql+psycopg2://username:password@host:port/database')

# 将DataFrame保存到PostgreSQL数据库，自动创建表
df.to_sql('table_name', engine, index=False, if_exists='replace')

print("DataFrame has been saved to the database.")
