root@VM-0-8-ubuntu:~/app/web/.next/static/chunks# cat 9469-bd8f07fc4003a374.js
!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},r=(new e.Error).stack;r&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[r]="67c00fad-e96a-4436-a398-e713138e9e46",e._sentryDebugIdIdentifier="sentry-dbid-67c00fad-e96a-4436-a398-e713138e9e46")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9469],{49469:function(e,r,t){t.d(r,{b:function(){return I}});var a=t(35250),s=t(80838),l=t(70079),n=t(67791),o=t(89200),d=t(79970),i=t(64885),c=t(76939),u=t(14343),p=t(99845),h=t(91237),m=t(85116),x=t(47300),y=t(13822),L=t(41296),f=t(59004),A=t(59815),j=t(12294),v=t(1128),M=t(75059);let g=x.z.object({secretKey:x.z.string().optional(),provider:x.z.string().min(1,"Please add a provider name that identifies this connection."),adapter:x.z.nativeEnum(h.LLMAdapter),baseURL:x.z.union([x.z.literal(""),x.z.string().url()]),withDefaultModels:x.z.boolean(),customModels:x.z.array(x.z.object({value:x.z.string().min(1)})),awsAccessKeyId:x.z.string().optional(),awsSecretAccessKey:x.z.string().optional(),awsRegion:x.z.string().optional()}).refine(e=>e.withDefaultModels||e.customModels.length>0,{message:"At least one custom model name is required when default models are disabled.",path:["withDefaultModels"]}).refine(e=>e.adapter!==h.LLMAdapter.Bedrock||e.awsAccessKeyId&&e.awsSecretAccessKey&&e.awsRegion,{message:"AWS credentials are required when using Bedrock adapter.",path:["adapter"]}).refine(e=>e.adapter===h.LLMAdapter.Bedrock||e.secretKey,{message:"Secret key is required.",path:["secretKey"]});function w(e){let{projectId:r,evalModelsOnly:t,onSuccess:l,customization:o}=e,d=j.h.useUtils(),i=(0,M.J)(),c=j.h.llmApiKey.all.useQuery({projectId:r},{enabled:!!r}),x=j.h.llmApiKey.create.useMutation({onSuccess:()=>d.llmApiKey.invalidate()}),w=j.h.llmApiKey.test.useMutation(),I=(null==o?void 0:o.defaultModelAdapter)?h.LLMAdapter[o.defaultModelAdapter]:h.LLMAdapter.OpenAI,k=e=>{var r,t,a;switch(e){case h.LLMAdapter.OpenAI:return null!==(r=null==o?void 0:o.defaultBaseUrlOpenAI)&&void 0!==r?r:"";case h.LLMAdapter.Azure:return null!==(t=null==o?void 0:o.defaultBaseUrlAzure)&&void 0!==t?t:"";case h.LLMAdapter.Anthropic:return null!==(a=null==o?void 0:o.defaultBaseUrlAnthropic)&&void 0!==a?a:"";default:return""}},b=(0,u.cI)({resolver:(0,p.F)(g),defaultValues:{adapter:I,provider:"",secretKey:"",baseURL:k(I),withDefaultModels:!0,customModels:[]}}),K=b.watch("adapter"),{fields:_,append:z,remove:N}=(0,u.Dq)({control:b.control,name:"customModels"});async function C(e){var t,a,s,n;let o;if(!r)return console.error("No project ID found.");if(null==c?void 0:null===(t=c.data)||void 0===t?void 0:t.data.map(e=>e.provider).includes(e.provider)){b.setError("provider",{type:"manual",message:"There already exists an API key for this provider."});return}i("project_settings:llm_api_key_create",{provider:e.provider});let d=e.secretKey;K===h.LLMAdapter.Bedrock&&(d=JSON.stringify({accessKeyId:null!==(a=e.awsAccessKeyId)&&void 0!==a?a:"",secretAccessKey:null!==(s=e.awsSecretAccessKey)&&void 0!==s?s:""}),o={region:null!==(n=e.awsRegion)&&void 0!==n?n:""});let u={projectId:r,secretKey:null!=d?d:"",provider:e.provider,adapter:e.adapter,baseURL:e.baseURL||void 0,withDefaultModels:e.withDefaultModels,config:o,customModels:e.customModels.map(e=>e.value.trim()).filter(Boolean)};try{let e=await w.mutateAsync(u);if(!e.success)throw Error(e.error)}catch(e){console.error(e),b.setError("secretKey",{type:"manual",message:e instanceof Error?e.message:"Could not verify the API key."});return}return x.mutateAsync(u).then(()=>{b.reset(),l()}).catch(e=>{console.error(e)})}return(0,a.jsx)(y.l0,{...b,"data-sentry-element":"Form","data-sentry-component":"CreateLLMApiKeyForm","data-sentry-source-file":"CreateLLMApiKeyForm.tsx",children:(0,a.jsxs)("form",{className:(0,v.cn)("flex flex-col gap-6 overflow-auto pb-2 pl-1 pr-4"),onSubmit:b.handleSubmit(C),children:[(0,a.jsx)(y.Wi,{control:b.control,name:"provider",render:e=>{let{field:r}=e;return(0,a.jsxs)(y.xJ,{children:[(0,a.jsx)(y.lX,{children:"Provider name"}),(0,a.jsx)(y.pf,{children:"Name to identify the key within Langfuse."}),(0,a.jsx)(y.NI,{children:(0,a.jsx)(L.I,{...r})}),(0,a.jsx)(y.zG,{})]})},"data-sentry-element":"FormField","data-sentry-source-file":"CreateLLMApiKeyForm.tsx"}),(0,a.jsx)(y.Wi,{control:b.control,name:"adapter",render:e=>{let{field:r}=e;return(0,a.jsxs)(y.xJ,{children:[(0,a.jsx)(y.lX,{children:"LLM adapter"}),(0,a.jsx)(y.pf,{children:"Schema that is accepted at that provider endpoint."}),(0,a.jsxs)(f.Ph,{defaultValue:r.value,onValueChange:e=>{r.onChange(e),b.setValue("baseURL",k(e))},children:[(0,a.jsx)(y.NI,{children:(0,a.jsx)(f.i4,{children:(0,a.jsx)(f.ki,{placeholder:"Select a LLM provider"})})}),(0,a.jsx)(f.Bw,{children:Object.values(h.LLMAdapter).filter(e=>!t||e===h.LLMAdapter.OpenAI||e===h.LLMAdapter.Azure).map(e=>(0,a.jsx)(f.Ql,{value:e,children:e},e))})]}),(0,a.jsx)(y.zG,{})]})},"data-sentry-element":"FormField","data-sentry-source-file":"CreateLLMApiKeyForm.tsx"}),K!==h.LLMAdapter.Bedrock&&(0,a.jsx)(y.Wi,{control:b.control,name:"baseURL",render:e=>{let{field:r}=e;return(0,a.jsxs)(y.xJ,{children:[(0,a.jsx)(y.lX,{children:"API Base URL"}),(0,a.jsxs)(y.pf,{children:["Leave blank to use the default base URL for the given LLM adapter."," ",K===h.LLMAdapter.OpenAI&&(0,a.jsx)("span",{children:"OpenAI default: https://api.openai.com/v1"}),K===h.LLMAdapter.Azure&&(0,a.jsx)("span",{children:"Please add the base URL in the following format (or compatible API): https://{instanceName}.openai.azure.com/openai/deployments"}),K===h.LLMAdapter.Anthropic&&(0,a.jsx)("span",{children:"Anthropic default: https://api.anthropic.com (excluding /v1/messages)"})]}),(0,a.jsx)(y.NI,{children:(0,a.jsx)(L.I,{...r,placeholder:"default"})}),(0,a.jsx)(y.zG,{})]})}}),K===h.LLMAdapter.Bedrock?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Wi,{control:b.control,name:"awsRegion",render:e=>{let{field:r}=e;return(0,a.jsxs)(y.xJ,{children:[(0,a.jsx)(y.lX,{children:"AWS Region"}),(0,a.jsx)(y.NI,{children:(0,a.jsx)(L.I,{...r})}),(0,a.jsx)(y.zG,{})]})}}),(0,a.jsx)(y.Wi,{control:b.control,name:"awsAccessKeyId",render:e=>{let{field:r}=e;return(0,a.jsxs)(y.xJ,{children:[(0,a.jsx)(y.lX,{children:"AWS Access Key ID"}),(0,a.jsx)(y.pf,{children:"These should be long-lived credentials for an AWS user with `bedrock:InvokeModel` permission."}),(0,a.jsx)(y.NI,{children:(0,a.jsx)(L.I,{...r})}),(0,a.jsx)(y.zG,{})]})}}),(0,a.jsx)(y.Wi,{control:b.control,name:"awsSecretAccessKey",render:e=>{let{field:r}=e;return(0,a.jsxs)(y.xJ,{children:[(0,a.jsx)(y.lX,{children:"AWS Secret Access Key"}),(0,a.jsx)(y.NI,{children:(0,a.jsx)(L.I,{...r,type:"password"})}),(0,a.jsx)(y.zG,{})]})}})]}):(0,a.jsx)(y.Wi,{control:b.control,name:"secretKey",render:e=>{let{field:r}=e;return(0,a.jsxs)(y.xJ,{children:[(0,a.jsx)(y.lX,{children:"API Key"}),(0,a.jsx)(y.pf,{children:"Your API keys are stored encrypted on our servers."}),K===h.LLMAdapter.VertexAI&&(0,a.jsxs)(y.pf,{className:"text-dark-yellow",children:["Paste your GCP service account JSON key here. The service account must have `Vertex AI User` role permissions. Example JSON:",(0,a.jsx)("pre",{className:"text-xs",children:'{\n  "type": "service_account",\n  "project_id": "<project_id>",\n  "private_key_id": "<private_key_id>",\n  "private_key": "<private_key>",\n  "client_email": "<client_email>",\n  "client_id": "<client_id>",\n  "auth_uri": "<auth_uri>",\n  "token_uri": "<token_uri>",\n  "auth_provider_x509_cert_url": "<auth_provider_x509_cert_url>",\n  "client_x509_cert_url": "<client_x509_cert_url>",\n}'})]}),(0,a.jsx)(y.NI,{children:(0,a.jsx)(L.I,{...r})}),(0,a.jsx)(y.zG,{})]})}}),(0,a.jsx)(y.Wi,{control:b.control,name:"withDefaultModels",render:e=>{let{field:r}=e;return(0,a.jsxs)(y.xJ,{children:[(0,a.jsxs)("span",{className:"row flex",children:[(0,a.jsxs)("span",{className:"flex-1",children:[(0,a.jsx)(y.lX,{children:"Enable default models"}),(0,a.jsx)(y.pf,{children:"Default models for the selected adapter will be available in Langfuse features."}),K===h.LLMAdapter.Azure&&(0,a.jsx)(y.pf,{className:"text-dark-yellow",children:"Azure LLM adapter does not support default models. Please add a custom model with your deployment name."}),K===h.LLMAdapter.Bedrock&&(0,a.jsx)(y.pf,{className:"text-dark-yellow",children:"Bedrock LLM adapter does not support default models. Please add your enabled Bedrock model IDs."})]}),(0,a.jsx)(y.NI,{children:(0,a.jsx)(A.r,{disabled:K===h.LLMAdapter.Azure||K===h.LLMAdapter.Bedrock,checked:K!==h.LLMAdapter.Azure&&K!==h.LLMAdapter.Bedrock&&r.value,onCheckedChange:r.onChange})})]}),(0,a.jsx)(y.zG,{})]})},"data-sentry-element":"FormField","data-sentry-source-file":"CreateLLMApiKeyForm.tsx"}),(0,a.jsx)(y.Wi,{control:b.control,name:"customModels",render:()=>(0,a.jsxs)(y.xJ,{children:[(0,a.jsx)(y.lX,{children:"Custom models"}),(0,a.jsx)(y.pf,{children:"Custom model names accepted by given endpoint."}),K===h.LLMAdapter.Azure&&(0,a.jsx)(y.pf,{className:"text-dark-yellow",children:"For Azure, the model name should be the same as the deployment name in Azure. For evals, choose a model with function calling capabilities."}),K===h.LLMAdapter.Bedrock&&(0,a.jsx)(y.pf,{className:"text-dark-yellow",children:"For Bedrock, the model name is the Bedrock model ID, e.g. 'eu.anthropic.claude-3-5-sonnet-20240620-v1:0'"}),_.map((e,r)=>(0,a.jsxs)("span",{className:"flex flex-row space-x-2",children:[(0,a.jsx)(L.I,{...b.register("customModels.".concat(r,".value")),placeholder:"Custom model name ".concat(r+1)}),(0,a.jsx)(n.z,{type:"button",variant:"ghost",onClick:()=>N(r),children:(0,a.jsx)(m.Z,{className:"h-4 w-4"})})]},r)),(0,a.jsxs)(n.z,{type:"button",variant:"ghost",onClick:()=>z({value:""}),className:"w-full",children:[(0,a.jsx)(s.Z,{className:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true"}),"Add custom model name"]})]}),"data-sentry-element":"FormField","data-sentry-source-file":"CreateLLMApiKeyForm.tsx"}),(0,a.jsx)(n.z,{type:"submit",className:"w-full",loading:b.formState.isSubmitting,"data-sentry-element":"Button","data-sentry-source-file":"CreateLLMApiKeyForm.tsx",children:"Save new LLM API key"}),(0,a.jsx)(y.zG,{"data-sentry-element":"FormMessage","data-sentry-source-file":"CreateLLMApiKeyForm.tsx"})]})})}function I(e){let{evalModelsOnly:r}=e,t=(0,i.Z)(),[u,p]=(0,l.useState)(!1),h=(0,d.ZM)({projectId:t,scope:"llmApiKeys:create"}),m=(0,c.N)();return h?(0,a.jsxs)(o.Vq,{open:u,onOpenChange:e=>{p(e)},"data-sentry-element":"Dialog","data-sentry-component":"CreateLLMApiKeyDialog","data-sentry-source-file":"CreateLLMApiKeyDialog.tsx",children:[(0,a.jsx)(o.hg,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"CreateLLMApiKeyDialog.tsx",children:(0,a.jsxs)(n.z,{variant:"secondary","data-sentry-element":"Button","data-sentry-source-file":"CreateLLMApiKeyDialog.tsx",children:[(0,a.jsx)(s.Z,{className:"-ml-0.5 mr-1.5 h-5 w-5","aria-hidden":"true","data-sentry-element":"PlusIcon","data-sentry-source-file":"CreateLLMApiKeyDialog.tsx"}),"Add new LLM API key"]})}),(0,a.jsxs)(o.cZ,{className:"max-h-[90%] min-w-[40vw] overflow-auto","data-sentry-element":"DialogContent","data-sentry-source-file":"CreateLLMApiKeyDialog.tsx",children:[(0,a.jsx)(o.fK,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreateLLMApiKeyDialog.tsx",children:(0,a.jsx)(o.$N,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"CreateLLMApiKeyDialog.tsx",children:"Add new LLM API key"})}),u&&(0,a.jsx)(w,{projectId:t,evalModelsOnly:r,onSuccess:()=>p(!1),customization:m})]})]}):null}}}]);
